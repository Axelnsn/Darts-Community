# Story 3.4: Club History Timeline (Read-Only)

## Status: Draft

## Story

**As a** player,
**I want** to see my club history,
**so that** my career path is documented.

## Acceptance Criteria

1. Club history section on profile view
2. Displays chronological list of clubs with dates
3. Current club marked as "Actuel"
4. History initially empty (populated by future transfer system)
5. Read-only display (no manual editing for MVP)
6. Placeholder message when no history exists

## Tasks / Subtasks

- [ ] Task 1: Create ClubHistory Model & Migration (AC: 2)
  - [ ] Create ClubHistory model
  - [ ] Create migration with player_id, club_id, joined_at, left_at
  - [ ] Add relationships

- [ ] Task 2: Auto-Record Club Changes (AC: 4)
  - [ ] Update PlayerService.updateProfile
  - [ ] Record history when club_id changes
  - [ ] Close previous history entry (set left_at)
  - [ ] Open new history entry (set joined_at)

- [ ] Task 3: Display History on Profile (AC: 1, 2, 3, 6)
  - [ ] Add club history section to profile view
  - [ ] Display chronological list
  - [ ] Mark current club as "Actuel"
  - [ ] Show placeholder when empty

- [ ] Task 4: Read-Only Display (AC: 5)
  - [ ] No edit interface for MVP
  - [ ] History managed automatically

## Dev Notes

### Relevant Architecture References

**ClubHistory Model:**
```php
- id: bigint unsigned
- player_id: bigint unsigned
- club_id: bigint unsigned
- joined_at: date
- left_at: date nullable
```

**Recording Club Change (from architecture.md):**
```php
private function recordClubChange(Player $player, ?int $newClubId): void
{
    if ($player->club_id) {
        ClubHistory::where('player_id', $player->id)
            ->whereNull('left_at')
            ->update(['left_at' => now()]);
    }

    if ($newClubId) {
        ClubHistory::create([
            'player_id' => $player->id,
            'club_id' => $newClubId,
            'joined_at' => now(),
        ]);
    }
}
```

### Testing

**Test Location:** `tests/Feature/Profile/ClubHistoryTest.php`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-08 | 1.0 | Initial story creation from PRD | Sarah (PO) |
