# Story 7.1: Admin Dashboard & Analytics

## Status: Draft

## Story

**As an** administrator,
**I want** to see a dashboard with key platform metrics,
**so that** I can monitor the health and growth of Darts Community.

## Acceptance Criteria

1. Admin dashboard accessible at /admin route
2. Key metrics displayed:
   - Total registered users
   - New registrations (today, this week, this month)
   - Active users (DAU/MAU)
   - Profiles completed (%)
   - Setups configured (%)
3. Simple charts/graphs for trends over time
4. Quick links to other admin sections
5. Dashboard refreshes on page load (no real-time updates for MVP)

## Tasks / Subtasks

- [ ] Task 1: Create AdminDashboardController (AC: 1)
  - [ ] Create `app/Http/Controllers/Admin/DashboardController.php`
  - [ ] Implement index method with metrics

- [ ] Task 2: Calculate Metrics (AC: 2)
  - [ ] Total users count
  - [ ] Registrations today/week/month
  - [ ] Active users (logged in last 7/30 days)
  - [ ] Profile completion percentage
  - [ ] Setup configuration percentage

- [ ] Task 3: Create Dashboard View (AC: 2, 4)
  - [ ] Create `resources/views/admin/dashboard.blade.php`
  - [ ] Display metric cards
  - [ ] Add quick links to admin sections

- [ ] Task 4: Charts (AC: 3)
  - [ ] Add simple registration trend chart
  - [ ] Use vanilla JS or Chart.js via CDN

- [ ] Task 5: Add Route (AC: 1)
  - [ ] Add GET /admin route

## Dev Notes

### Relevant Architecture References

**Metrics Queries:**
```php
$metrics = [
    'total_users' => User::count(),
    'today_registrations' => User::whereDate('created_at', today())->count(),
    'week_registrations' => User::where('created_at', '>=', now()->subWeek())->count(),
    'month_registrations' => User::where('created_at', '>=', now()->subMonth())->count(),
    'active_users_7d' => User::where('last_login_at', '>=', now()->subDays(7))->count(),
    'profiles_complete' => Player::whereNotNull('first_name')->count() / max(User::count(), 1) * 100,
    'setups_configured' => Player::whereHas('dartAssemblies', fn($q) => $q->where('is_current_setup', true))->count(),
];
```

**Route:**
```php
Route::get('/admin', [DashboardController::class, 'index'])->name('admin.dashboard');
```

### Testing

**Test Location:** `tests/Feature/Admin/DashboardTest.php`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-08 | 1.0 | Initial story creation from PRD | Sarah (PO) |
