# Story 2.2: Profile Photo & Cover Image Upload

## Status: Draft

## Story

**As a** player,
**I want** to upload my profile photo and cover image,
**so that** my profile looks professional and personalized.

## Acceptance Criteria

1. Profile photo upload field (square, displayed as avatar)
2. Cover photo upload field (wide banner, Facebook-style)
3. Accepted formats: JPG, PNG, WebP
4. Maximum file size: 5MB per image
5. Images automatically resized/optimized on upload
6. Images stored in storage/app/public with proper paths
7. Default placeholder images shown when not uploaded
8. User can replace or remove uploaded images
9. MIME type validation to prevent malicious uploads

## Tasks / Subtasks

- [ ] Task 1: Create UploadService (AC: 5, 6, 9)
  - [ ] Create `app/Services/UploadService.php`
  - [ ] Implement image validation (MIME, size)
  - [ ] Implement image resizing (profile: 400x400, cover: 1200x400)
  - [ ] Store in `storage/app/public/avatars/` and `covers/`

- [ ] Task 2: Create ProfilePhotoController (AC: 1, 2, 8)
  - [ ] Create controller with store/destroy methods
  - [ ] Handle profile photo upload
  - [ ] Handle cover photo upload
  - [ ] Handle photo deletion

- [ ] Task 3: Create Upload Form Request (AC: 3, 4, 9)
  - [ ] Create PhotoUploadRequest
  - [ ] Validate file type (jpg, png, webp)
  - [ ] Validate file size (max 5MB)

- [ ] Task 4: Update Profile Edit View (AC: 1, 2, 7)
  - [ ] Add profile photo upload field with preview
  - [ ] Add cover photo upload field with preview
  - [ ] Show default placeholders
  - [ ] Add remove buttons

- [ ] Task 5: Storage Configuration (AC: 6)
  - [ ] Run `php artisan storage:link`
  - [ ] Configure filesystem for public disk

## Dev Notes

### Relevant Architecture References

**File Storage Structure:**
```
storage/app/public/
├── avatars/
│   └── {player_id}_{timestamp}.jpg
└── covers/
    └── {player_id}_{timestamp}.jpg
```

**UploadService Pattern:**
```php
public function uploadProfilePhoto(Player $player, UploadedFile $file): string
{
    // Validate, resize, store
    $path = $file->store('avatars', 'public');
    return $path;
}
```

**Image Sizes:**
- Profile photo: 400x400px (square)
- Cover photo: 1200x400px (3:1 ratio)

### Testing

**Test Location:** `tests/Feature/Profile/PhotoUploadTest.php`

Use `Storage::fake('public')` and `UploadedFile::fake()->image()` for testing.

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-08 | 1.0 | Initial story creation from PRD | Sarah (PO) |
